<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-05-15T09:21:07.2181097"><title>Использование WSL2 для тестирования и разработки PostgreSql | Postgres Полезные русурсы</title><script type="application/json" id="virtual-toc-data">[{"id":"wsl_importexport","level":0,"title":"Импорт и экспорт в wsl","anchor":"#wsl_importexport"},{"id":"wsl","level":0,"title":"Команды WSL","anchor":"#wsl"},{"id":"windows","level":0,"title":"Интеграция с Windows","anchor":"#windows"},{"id":"wsl_terminalcmd","level":0,"title":"Полезные команды в дистрибутиве wsl","anchor":"#wsl_terminalcmd"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="frontend/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="icon" type="image/png" sizes="32x32" href="writerside_32.png"><link rel="icon" type="image/png" sizes="64x64" href="writerside_64.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Использование WSL2 для тестирования и разработки PostgreSql | Postgres Полезные русурсы"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Postgres Полезные русурсы Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/wsl-devpostgres.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Использование WSL2 для тестирования и разработки PostgreSql | Postgres Полезные русурсы"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/wsl-devpostgres.html#webpage",
    "url": "writerside-documentation/wsl-devpostgres.html",
    "name": "Использование WSL2 для тестирования и разработки PostgreSql | Postgres Полезные русурсы",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Postgres Полезные русурсы Help"
}</script><!-- End Schema.org --></head><body data-id="wsl-devpostgres" data-main-title="Использование WSL2 для тестирования и разработки PostgreSql" data-article-props="{&quot;seeAlso&quot;:[{&quot;title&quot;:&quot;&quot;,&quot;links&quot;:[{&quot;url&quot;:&quot;https://learn.microsoft.com/ru-ru/windows/wsl/setup/environment&quot;,&quot;text&quot;:&quot;Настройка среды разработки WSL&quot;},{&quot;url&quot;:&quot;https://learn.microsoft.com/ru-ru/windows/wsl/wsl-config&quot;,&quot;text&quot;:&quot;Настройка дополнительных параметров в WSL&quot;},{&quot;url&quot;:&quot;https://github.com/MicrosoftDocs/WSL/blob/main/README.md&quot;,&quot;text&quot;:&quot;WSL Documentation&quot;},{&quot;url&quot;:&quot;https://learn.microsoft.com/ru-ru/windows/wsl/basic-commands&quot;,&quot;text&quot;:&quot;Основные команды для WSL&quot;}]}],&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Default-topic.md|Postgres - полезные ресурсы, руководства подсказки, советы///postgres-install.md|Установка PostgreSql"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Postgres Полезные русурсы  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="wsl-devpostgres" id="wsl-devpostgres.md">Использование WSL2 для тестирования и разработки PostgreSql</h1><p id="-wz6elz_509">Использование WSL дает возможности быстрого развертывания клиентских утилит</p><p id="-wz6elz_510">При наличии проблем с установкой на WLS2 прочитать <a href="https://www.postgresql.org/download/linux/ubuntu/" id="-wz6elz_511" data-external="true" rel="noopener noreferrer">официальную документацию</a> или как вариант попробовать (вариант для Ubuntu)</p><div class="code-block" data-lang="bash">
sudo sh -c 'echo &quot;deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; &gt; /etc/apt/sources.list.d/pgdg.list'
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
sudo apt-get update
</div><p id="-wz6elz_513">Установка клиента для v16</p><div class="code-block" data-lang="bash">
sudo apt install postgresql-client-16
</div><p id="-wz6elz_515">Теперь нам доступны клиентские утилиты в родной среде Postgres - в Linux!</p><p id="-wz6elz_516">Что дальше?</p><ul class="list _bullet" id="-wz6elz_517"><li class="list__item" id="-wz6elz_518"><p>в терминале wsl набираем <code class="code" id="-wz6elz_519">psql -h &lt;dbhost&gt; -p &lt;portNo&gt; -U &lt;username&gt;</code> и подключаемся</p></li><li class="list__item" id="-wz6elz_520"><p>в терминале wsl устанавливаем VSCode, сделать это очень просто, набираем в терминале <code class="code" id="-wz6elz_521">code .</code>. Для того что бы открыть в VSCode папку со своими рабочими скриптами (пусть это будет папка d:\tmp\MyPsql) в терминале набираем <code class="code" id="-wz6elz_522">code /mnt/d/tmp/MyPsql/</code></p></li><li class="list__item" id="-wz6elz_523"><p><code class="code" id="-wz6elz_524">wsl psql -h 192.168.0.133 -p 5433 -U postgres</code> - выполнить psql из терминала cmd или powershell windows.</p></li><li class="list__item" id="-wz6elz_525"><p><code class="code" id="-wz6elz_526">wsl -d Rocky9 psql -h 192.168.0.133 -p 5433 -U postgres</code> или <code class="code" id="-wz6elz_527">wsl -d Ubuntu psql -h 192.168.0.133 -p 5433 -U postgres</code> - выполнить psql в указанном дистрибутиве WSL</p></li></ul><p id="-wz6elz_528">Не забываем <a href="howto-mainclientfile.html" id="-wz6elz_529" data-tooltip="В Windows, файл pgpass.conf расположен %APPDATA%\postgresql\ что обычно соответсвует C:\Users\&lt;YourUsername&gt;\AppData\Roaming\postgresql">настроить важные файлы</a></p><section class="chapter"><h2 id="wsl_importexport" data-toc="wsl_importexport">Импорт и экспорт в wsl</h2><p id="-wz6elz_530">Настроили образ, установили все необходимое - время сохранится.</p><p id="-wz6elz_531">Для сохранения образа: <code class="code" id="-wz6elz_532">wsl --export &lt;WSL Image Name&gt; &lt;Export file&gt;</code>, например с использованием powershell терминала:</p><div class="code-block" data-lang="bash">
wsl --list --verbose
wsl --terminate Ubuntu
wsl --export Ubuntu d:\wslDistroStorage\bak\ubuntuDef.tar
</div><p id="-wz6elz_534">Результат:</p><div class="code-block" data-lang="plaintext">
wsl --export Ubuntu d:\wslDistroStorage\bak\ubuntuDef.tar
Выполняется экспорт. Это может занять несколько минут.
Операция успешно завершена.
</div><p id="-wz6elz_536">Для импорта, отключаем дистрибутив</p><div class="code-block" data-lang="bash">
wsl --unregister Ubuntu
</div><p id="-wz6elz_538">Восстанавливаем</p><div class="code-block" data-lang="bash">
wsl --import Ubuntu d:\wslVM\Ubuntu d:\wslDistroStorage\bak\ubuntuDef.tar
</div><p id="-wz6elz_540">Если необходимо устанавливаем его по умолчанию</p><div class="code-block" data-lang="bash">
wsl --setdefault Ubuntu
</div><p id="-wz6elz_542">Добавить пользователя по умолчанию, <span class="control" id="-wz6elz_543">username</span> - меняем на имя пользователя</p><div class="code-block" data-lang="bash">
ubuntu config --default-user &lt;username&gt;
</div></section><section class="chapter"><h2 id="wsl" data-toc="wsl">Команды WSL</h2><ul class="list _bullet" id="-wz6elz_545"><li class="list__item" id="-wz6elz_546"><p><code class="code" id="-wz6elz_547">wsl --shutdown</code> - остановка wsl</p></li><li class="list__item" id="-wz6elz_548"><p><code class="code" id="-wz6elz_549">wsl --terminate &lt;distroName&gt;</code> остановка указанного дистрибутива</p></li><li class="list__item" id="-wz6elz_550"><p><code class="code" id="-wz6elz_551">wsl -d &lt;distroName&gt;</code> запуск указанного дистрибутива</p></li><li class="list__item" id="-wz6elz_552"><p><code class="code" id="-wz6elz_553">wsl --unregister Debian</code> - удаление соответствующего дистрибутива с именем Debian</p></li><li class="list__item" id="-wz6elz_554"><p><code class="code" id="-wz6elz_555">wsl --export &lt;distro&gt; &lt;filename.tar&gt;</code> - экспорт в файл</p></li><li class="list__item" id="-wz6elz_556"><p><code class="code" id="-wz6elz_557">wsl --import (distribution) (install location) (file location and filename)</code> - импорт, например: <code class="code" id="-wz6elz_558">wsl --import Debian C:\Users\MyPC\AppData\Local\Packages\Debian D:\tmp\debianbackup.tar</code></p></li><li class="list__item" id="-wz6elz_559"><p><code class="code" id="-wz6elz_560">wls --list</code> - список систем</p></li><li class="list__item" id="-wz6elz_561"><p><code class="code" id="-wz6elz_562">wsl --list --online</code> - список доступных в online для установки</p></li><li class="list__item" id="-wz6elz_563"><p><code class="code" id="-wz6elz_564">wsl --setdefault DISTRO-NAME</code> - установить основной дистрибутив</p></li><li class="list__item" id="-wz6elz_565"><p><code class="code" id="-wz6elz_566">ubuntu config --default-user root</code> - Переключение пользователя по умолчанию на <span class="control" id="-wz6elz_567">root</span>. Под root можно добавить пользователей, когда мы уже находимся в wsl <code class="code" id="-wz6elz_568">adduser &lt;username&gt;</code></p></li><li class="list__item" id="-wz6elz_569"><p><code class="code" id="-wz6elz_570">ubuntu config --default-user &lt;username&gt;</code> - Переключение пользователя по умолчанию на <span class="control" id="-wz6elz_571">username</span></p></li></ul></section><section class="chapter"><h2 id="windows" data-toc="windows">Интеграция с Windows</h2><ul class="list _bullet" id="-wz6elz_572"><li class="list__item" id="-wz6elz_573"><p><code class="code" id="-wz6elz_574">\wsl$\</code> - открыть папку в проводнике дистрибутива linux по умолчанию</p></li><li class="list__item" id="-wz6elz_575"><p><code class="code" id="-wz6elz_576">\wsl$\Ubuntu</code> - открыть в проводнике папку в дистрибутиве Ubuntu</p></li><li class="list__item" id="-wz6elz_577"><p><code class="code" id="-wz6elz_578">\wsl.localhost\&lt;disro_name&gt;</code> - открыть в проводнике папку в дистрибутиве Ubuntu</p></li><li class="list__item" id="-wz6elz_579"><p><code class="code" id="-wz6elz_580">\wsl$\Ubuntu\home\&lt;username&gt;</code> - открыть в проводнике папку в дистрибутиве Ubuntu пользователя</p></li><li class="list__item" id="-wz6elz_581"><p><code class="code" id="-wz6elz_582">\wsl$\Rocky9\home\&lt;username&gt;</code> - открыть в проводнике папку в дистрибутиве Rocky9 пользователя</p></li></ul><p id="-wz6elz_583"><span class="control" id="-wz6elz_584">Где установлена wsl Ubuntu или другой дистрибутив?</span><br> Ubuntu по умолчанию: <code class="code" id="-wz6elz_586">C:\Users\&lt;username&gt;\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu....\LocalState</code>. для поиска используем</p><p id="-wz6elz_587">Если в терминале cmd или powershell выполнить команду <code class="code" id="-wz6elz_588">bash</code> - вы попадаете в терминал wsl установленный по умолчанию.</p><div class="code-block" data-lang="bash">
(Get-ChildItem -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Lxss | Where-Object { $_.GetValue(&quot;DistributionName&quot;) -eq '&lt;distribution-name&gt;' }).GetValue(&quot;BasePath&quot;) + &quot;\ext4.vhdx&quot;
</div><p id="-wz6elz_590"><span class="control" id="-wz6elz_591">Могу ли я запустить и выполнить exe файл в терминале wsl?</span><br> Да. Попробуйте запустить для проверки <code class="code" id="-wz6elz_593">ipconfig.exe /all</code></p><p id="-wz6elz_594"><span class="control" id="-wz6elz_595">Могу ли я запустить программу из дистрибутива wsl windows?</span><br> Да. Например, в терминале wsl выполнить <code class="code" id="-wz6elz_597">ps -aux</code>. Для запуска программы из windows (в терминале cmd): <code class="code" id="-wz6elz_598">wsl ps -aux</code> Вы можете интегрировать данные, например при запуске из терминала powershell на windows: <code class="code" id="-wz6elz_599">Get-Process | wsl sed &quot;s/ */;/g&quot;</code> - вы выполняете: Get-Process передается в sed в среде Linux, заменяя все пробелы точкой с запятой</p></section><section class="chapter"><h2 id="wsl_terminalcmd" data-toc="wsl_terminalcmd">Полезные команды в дистрибутиве wsl</h2><p id="-wz6elz_600"><code class="code" id="-wz6elz_601">lsb_release -a</code> - узнать версию linux <code class="code" id="-wz6elz_602">cd /mnt/c</code> - перейти в корень диска C. Диски по умолчанию монтируются автоматически.</p></section><div class="last-modified">Last modified: 15 мая 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="postgres-installrockywsl.html" class="navigation-links__prev">Установка Rocky Linux WSL2</a><a href="postgres-backup-logical.html" class="navigation-links__next">Резервное копирование и восстановление</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="frontend/app.js"></script></body></html>